<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> PDFModule</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Modules</h3><ul><li><a href="module-AboutModule.html">AboutModule</a></li><li><a href="module-AuthModule.html">AuthModule</a></li><li><a href="module-BackupModule.html">BackupModule</a></li><li><a href="module-ClientsModule.html">ClientsModule</a></li><li><a href="module-ConfigModule.html">ConfigModule</a></li><li><a href="module-DashboardModule.html">DashboardModule</a></li><li><a href="module-DataCache.html">DataCache</a></li><li><a href="module-ExportModule.html">ExportModule</a></li><li><a href="module-FECModule.html">FECModule</a></li><li><a href="module-FollowUpModule.html">FollowUpModule</a></li><li><a href="module-ImportModule.html">ImportModule</a></li><li><a href="module-InvoicesModule.html">InvoicesModule</a></li><li><a href="module-KeyboardShortcutsModule.html">KeyboardShortcutsModule</a></li><li><a href="module-Logger.html">Logger</a></li><li><a href="module-MLService.html">MLService</a></li><li><a href="module-MaterialsModule.html">MaterialsModule</a></li><li><a href="module-NotificationSystem.html">NotificationSystem</a></li><li><a href="module-NotificationSystemV2.html">NotificationSystemV2</a></li><li><a href="module-PDFModule.html">PDFModule</a></li><li><a href="module-QuickAddModule.html">QuickAddModule</a></li><li><a href="module-QuoteBuilderModule.html">QuoteBuilderModule</a></li><li><a href="module-QuotesModule.html">QuotesModule</a></li><li><a href="module-RevenueModule.html">RevenueModule</a></li><li><a href="module-ScannerModule.html">ScannerModule</a></li><li><a href="module-SuppliersModule.html">SuppliersModule</a></li><li><a href="module-TemplatesModule.html">TemplatesModule</a></li><li><a href="module-TourModule.html">TourModule</a></li><li><a href="module-UtilitiesModule.html">UtilitiesModule</a></li><li><a href="module-calculations.html">calculations</a></li><li><a href="module-constants.html">constants</a></li><li><a href="module-formatters.html">formatters</a></li><li><a href="module-helpers.html">helpers</a></li></ul><h3>Classes</h3><ul><li><a href="BaseModule.html">BaseModule</a></li><li><a href="BulkActionsManager.html">BulkActionsManager</a></li><li><a href="CacheKeys.html">CacheKeys</a></li><li><a href="EventBus.html">EventBus</a></li><li><a href="LoadingStateManager.html">LoadingStateManager</a></li><li><a href="ModalHelper.html">ModalHelper</a></li><li><a href="PaginationManager.html">PaginationManager</a></li><li><a href="ServerValidator.html">ServerValidator</a></li><li><a href="StateManager.html">StateManager</a></li><li><a href="TabRefreshManager.html">TabRefreshManager</a></li><li><a href="UndoRedoManager.html">UndoRedoManager</a></li><li><a href="module-AboutModule-AboutModule.html">AboutModule</a></li><li><a href="module-AuthModule-AuthModule.html">AuthModule</a></li><li><a href="module-BackupModule-BackupModule.html">BackupModule</a></li><li><a href="module-ClientsModule-ClientsModule.html">ClientsModule</a></li><li><a href="module-ConfigModule-ConfigModule.html">ConfigModule</a></li><li><a href="module-DashboardModule-DashboardModule.html">DashboardModule</a></li><li><a href="module-ExportModule-ExportModule.html">ExportModule</a></li><li><a href="module-FECModule-FECModule.html">FECModule</a></li><li><a href="module-ImportModule-ImportModule.html">ImportModule</a></li><li><a href="module-InvoicesModule-InvoicesModule.html">InvoicesModule</a></li><li><a href="module-Logger-Logger.html">Logger</a></li><li><a href="module-Logger-ModuleLogger.html">ModuleLogger</a></li><li><a href="module-MaterialsModule-MaterialsModule.html">MaterialsModule</a></li><li><a href="module-PDFModule-PDFModule.html">PDFModule</a></li><li><a href="module-QuickAddModule-QuickAddModule.html">QuickAddModule</a></li><li><a href="module-QuoteBuilderModule-QuoteBuilderModule.html">QuoteBuilderModule</a></li><li><a href="module-QuotesModule-QuotesModule.html">QuotesModule</a></li><li><a href="module-RevenueModule-RevenueModule.html">RevenueModule</a></li><li><a href="module-ScannerModule-ScannerModule.html">ScannerModule</a></li><li><a href="module-SuppliersModule-SuppliersModule.html">SuppliersModule</a></li><li><a href="module-TemplatesModule-TemplatesModule.html">TemplatesModule</a></li><li><a href="module-UtilitiesModule-UtilitiesModule.html">UtilitiesModule</a></li></ul><h3>Global</h3><ul><li><a href="global.html#clear">clear</a></li><li><a href="global.html#crypto">crypto</a></li><li><a href="global.html#emit">emit</a></li><li><a href="global.html#emitSync">emitSync</a></li><li><a href="global.html#off">off</a></li><li><a href="global.html#on">on</a></li><li><a href="global.html#once">once</a></li><li><a href="global.html#validateBeforeAddToQuote">validateBeforeAddToQuote</a></li><li><a href="global.html#validateBeforeExport">validateBeforeExport</a></li><li><a href="global.html#validateBeforeSaveMaterial">validateBeforeSaveMaterial</a></li><li><a href="global.html#validateBeforeSendEmail">validateBeforeSendEmail</a></li><li><a href="global.html#validateHeaderConfig">validateHeaderConfig</a></li><li><a href="global.html#validatePasswordChange">validatePasswordChange</a></li><li><a href="global.html#validateSMTPConfig">validateSMTPConfig</a></li><li><a href="global.html#waitFor">waitFor</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Module</p>
                    <h1>PDFModule</h1>
                </header>
                




<section>

<header>
    
        
            
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description"><h1>========================================
PDF MODULE - Génération de documents PDF</h1>
<p>Module de génération de documents PDF professionnels pour l'application AutoCalc OptiDevis.
Gère la création de devis et factures au format PDF avec 5 designs personnalisables,
ainsi que l'export, l'impression et l'envoi par email.</p>
<p>Architecture :
Le module s'appuie sur jsPDF pour générer des documents PDF multipages avec :</p>
<ul>
<li><strong>5 designs professionnels</strong> : Elegant, Modern, Minimalist, Artisan, Tech</li>
<li><strong>Génération devis</strong> : PDF multi-pages avec en-tête, articles, totaux, footer</li>
<li><strong>Génération factures</strong> : PDF avec mentions légales obligatoires</li>
<li><strong>Actions</strong> : Export (sauvegarde locale), Print (via IPC), Email (SMTP + pièce jointe)</li>
</ul>
<h1>==========================================
DESIGNS PDF DISPONIBLES (5 STYLES)</h1>
<p>Chaque design possède sa propre configuration (couleurs, typographie, layout) :</p>
<p><strong>1. Elegant</strong> (design par défaut) :</p>
<ul>
<li>Style professionnel et raffiné</li>
<li>Couleurs sobres (bleus/gris)</li>
<li>En-têtes avec logo + bande colorée</li>
<li>Totaux dans cadre élégant</li>
</ul>
<p><strong>2. Modern</strong> :</p>
<ul>
<li>Style contemporain avec bande latérale</li>
<li>Sidebar de 5mm sur toute la hauteur</li>
<li>Couleurs vives et contrastées</li>
<li>Layout moderne et épuré</li>
</ul>
<p><strong>3. Minimalist</strong> :</p>
<ul>
<li>Style minimaliste épuré</li>
<li>Peu de couleurs, beaucoup d'espace blanc</li>
<li>Lignes fines et discrètes</li>
<li>Maximum de clarté</li>
</ul>
<p><strong>4. Artisan</strong> :</p>
<ul>
<li>Style chaleureux et artisanal</li>
<li>Couleurs terre et bois</li>
<li>Typo manuscrite pour touches personnelles</li>
<li>Ambiance authentique</li>
</ul>
<p><strong>5. Tech</strong> :</p>
<ul>
<li>Style tech/digital avec sidebar</li>
<li>Couleurs électriques (cyan, violet)</li>
<li>Grille de fond techno</li>
<li>Aspect futuriste</li>
</ul>
<p>Chaque design définit :</p>
<ul>
<li><strong>colors</strong> : Palette de couleurs (primary, secondary, accent, text, border, etc.)</li>
<li><strong>typography</strong> : Tailles de police (title, subtitle, body, small) + famille</li>
<li><strong>layout</strong> : Dimensions (header, sidebar, spacing, margin)</li>
</ul>
<p>Sources : Objets globaux DESIGN_<em><em>QUOTE et DESIGN</em></em>_INVOICE dans pdf-templates.js</p>
<h1>==========================================
GÉNÉRATION PDF - WORKFLOW DEVIS</h1>
<p>Étapes de génération d'un devis PDF :</p>
<ol>
<li><strong>Synchronisation clientInfo</strong> avec formulaire</li>
<li><strong>Création instance jsPDF</strong> (A4 portrait)</li>
<li><strong>Sélection design</strong> selon headerConfig.pdfDesign</li>
<li><strong>Bande latérale</strong> (si Modern/Tech)</li>
<li><strong>En-tête</strong> : Logo + nom entreprise + type document + numéro + date</li>
<li><strong>Infos entreprise/client</strong> : Coordonnées en 2 colonnes</li>
<li><strong>Date et validité</strong> : Date devis + validité 1 mois</li>
<li><strong>Filtrage items</strong> : Validation des articles (nom, quantité &gt; 0, prix &gt; 0)</li>
<li><strong>Tableau articles</strong> : Nom, quantité, calcul, PU HT/TTC, Total</li>
<li><strong>Calcul totaux</strong> : HT, TVA, TTC + remise si applicable</li>
<li><strong>Carte totaux</strong> : Encadré récapitulatif</li>
<li><strong>Conditions additionnelles</strong> : CGV personnalisées</li>
<li><strong>Mentions légales</strong> : Infos légales entreprise</li>
<li><strong>Footer multi-pages</strong> : Pied de page sur chaque page (numéro page)</li>
</ol>
<p>Gestion pagination :</p>
<ul>
<li>Détection automatique de dépassement de page</li>
<li>Ajout de nouvelle page si nécessaire</li>
<li>Recopie de la sidebar sur nouvelles pages (Modern/Tech)</li>
</ul>
<h1>==========================================
GÉNÉRATION PDF - WORKFLOW FACTURE</h1>
<p>Similaire au devis avec spécificités factures :
1-6. Identique au devis (header, infos, etc.)
7. <strong>Infos facture</strong> : N° facture, date émission, devis associé, échéance
8-12. Tableau articles et totaux (identique)
13. <strong>Conditions de paiement légales</strong> (obligatoires) :
- Modalités de paiement (30j, 60j, etc.)
- Pénalités de retard (3× taux légal)
- Indemnité forfaitaire (40€ art. L441-6)
- Pas d'escompte pour paiement anticipé
14. Footer multi-pages</p>
<h1>==========================================
ACTIONS SUR LES PDF</h1>
<p><strong>Export PDF (sauvegarde locale)</strong> :</p>
<ul>
<li>Génération du document jsPDF</li>
<li>Appel à doc.save(filename)</li>
<li>Téléchargement navigateur</li>
<li>Nom fichier : devis_[client]<em>[date].pdf ou facture</em>[numero]_[client].pdf</li>
</ul>
<p><strong>Print PDF (impression)</strong> :</p>
<ul>
<li>Génération du document jsPDF</li>
<li>Conversion en base64 (doc.output('datauristring'))</li>
<li>Envoi via IPC 'print-pdf' à Electron main process</li>
<li>Ouverture dialogue impression OS</li>
</ul>
<p><strong>Email PDF (envoi SMTP)</strong> :</p>
<ul>
<li>Génération du document jsPDF</li>
<li>Conversion en base64 pour pièce jointe</li>
<li>Envoi via IPC 'send-quote-email' avec :
<ul>
<li>Destinataire (email client)</li>
<li>Sujet personnalisé</li>
<li>Corps de message</li>
<li>Pièce jointe PDF en base64</li>
</ul>
</li>
<li>SMTP configuré dans ConfigModule</li>
</ul>
<h1>==========================================
VALIDATION</h1>
<p>Avant génération PDF :</p>
<ul>
<li><strong>validateBeforeExport()</strong> : Vérifie items &gt; 0, clientInfo complet</li>
<li><strong>validateBeforeSendEmail()</strong> : Vérifie email client présent</li>
</ul>
<p>Pendant génération :</p>
<ul>
<li>Filtrage des items invalides (nom vide, quantité ≤ 0, prix ≤ 0)</li>
<li>Vérification design existe (fallback sur design par défaut si absent)</li>
<li>Vérification jsPDF chargé</li>
</ul>
<h1>==========================================
FONCTIONS HELPERS EXTERNES (pdf-templates.js)</h1>
<p>Le module s'appuie sur des fonctions globales définies dans lib/pdf-templates.js :</p>
<p><strong>Dessins de composants</strong> :</p>
<ul>
<li>drawHeader<a href="">Style</a> : En-tête avec logo + infos</li>
<li>drawInfoSection<a href="">Style</a> : Section entreprise/client</li>
<li>drawItemsTable() : Tableau des articles (jsPDF-autotable)</li>
<li>drawTotalsCard<a href="">Style</a> : Carte récapitulative des totaux</li>
<li>drawFooter<a href="">Style</a> : Pied de page avec numéro</li>
<li>drawSidebar() / drawSidebarTech() : Bandes latérales décoratives</li>
</ul>
<p><strong>Utilitaires</strong> :</p>
<ul>
<li>window.DateFormatter.toFrench() : Formatage dates FR</li>
<li>window.CurrencyFormatter.format() : Formatage monétaire</li>
</ul>
<h1>==========================================
INTÉGRATIONS</h1>
<ul>
<li><strong>jsPDF</strong> : Bibliothèque de génération PDF (window.jspdf)</li>
<li><strong>jsPDF-autotable</strong> : Plugin pour tableaux (autoTable())</li>
<li><strong>ConfigModule</strong> : headerConfig (logo, entreprise, design)</li>
<li><strong>QuoteBuilderModule</strong> : quoteItems, clientInfo</li>
<li><strong>IPC Electron</strong> : print-pdf, send-quote-email, load-invoice</li>
<li><strong>NotificationSystem</strong> : Feedback utilisateur</li>
</ul></div>
        

        
            














<dl class="details">

    
    <dt class="tag-version">Version:</dt>
    <dd class="tag-version"><ul class="dummy"><li>2.0.0</li></ul></dd>
    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>AutoCalc OptiDevis</li>
        </ul>
    </dd>
    

    

    

    
    

    

    

    
        <p class="tag-source">
            <a href="modules_pdf_PDFModule.js.html" class="button">View Source</a>
            <span>
                <a href="modules_pdf_PDFModule.js.html">modules/pdf/PDFModule.js</a>, <a href="modules_pdf_PDFModule.js.html#line1">line 1</a>
            </span>
        </p>
    
</dl>






















        
    
    </div>
    
    
        <h3 class="subsection-title">Extends</h3>

        


    <ul>
        <li><a href="BaseModule.html">BaseModule</a></li>
    </ul>


    

    

    
        <h3 class="subsection-title">Classes</h3>

        <dl>
            <dt><a href="module-PDFModule-PDFModule.html">PDFModule</a></dt>
            <dd></dd>
        </dl>
    

    

    

    

    

    

    

    
</article>

</section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>